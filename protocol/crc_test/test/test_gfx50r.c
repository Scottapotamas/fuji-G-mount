#include "unity.h"
#include <stdlib.h>

// MODULE UNDER TEST
#include "crc.h"
 
// DEFINITIONS 
#define CRC_DIVISOR 0xFF

// PRIVATE TYPES
 
// PRIVATE DATA
uint8_t temp_crc_1 = 0;

// PRIVATE FUNCTIONS
 
// SETUP, TEARDOWN
 
void setUp(void)
{
    temp_crc_1 = 0;
}
 
void tearDown(void)
{

}
 
// TESTS
void test_basic(void)
{
    TEST_IGNORE();
}

void test_body_announcement_first(void)
{
    uint8_t payload[] = {
        0x53, 0x50, 0x58, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x47, 0x46, 0x58, 0x20, 0x35, 0x30,
        0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x47, 0x46,
        0x58, 0x20, 0x35, 0x30, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x35, 0x39, 0x33,
        0x35, 0x33, 0x34, 0x33, 0x38, 0x33, 0x36, 0x33, 0x31, 0x31, 0x38, 0x31, 0x31, 0x31, 0x33, 0x39,
        0x37, 0x44, 0x30, 0x31, 0x30, 0x31, 0x31, 0x30, 0x38, 0x34, 0x31, 0x02, 0x20, 0x01, 0x35, 0x01,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };

    crc8( 0x00, &temp_crc_1 );
    crc8( 0x00, &temp_crc_1 );

    for( uint16_t i = 0; i < sizeof(payload); i++ )
    {
        crc8( payload[i], &temp_crc_1 );
    }

    TEST_ASSERT_EQUAL_HEX( 0x19, temp_crc_1 );

}

void test_body_announcement_second(void)
{
    uint8_t payload[] = {
        0x53, 0x50, 0x58, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x47, 0x46, 0x58, 0x20, 0x35, 0x30,
        0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x47, 0x46,
        0x58, 0x20, 0x35, 0x30, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x35, 0x39, 0x33,
        0x35, 0x33, 0x34, 0x33, 0x38, 0x33, 0x36, 0x33, 0x31, 0x31, 0x38, 0x31, 0x31, 0x31, 0x33, 0x39,
        0x37, 0x44, 0x30, 0x31, 0x30, 0x31, 0x31, 0x30, 0x38, 0x34, 0x31, 0x02, 0x20, 0x01, 0x35, 0x01,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };

    crc8( 0xFF, &temp_crc_1 );
    crc8( 0xFF, &temp_crc_1 );

    for( uint16_t i = 0; i < sizeof(payload); i++ )
    {
        crc8( payload[i], &temp_crc_1 );
    }

    TEST_ASSERT_EQUAL_HEX( 0x17, temp_crc_1 );
}